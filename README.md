# アニメおすすめシステム

このプロジェクトは、ユーザーの協調フィルタリングを使用してアニメをおすすめするシステムです。ユーザーの評価データに基づいて、類似した好みを持つ他のユーザーの評価を利用し、最適なアニメをレコメンドします。

## プロジェクトの構成

```ディレクトリ構造
.
├── app
│   ├── anime_app.py          # アプリのメインファイル
│   └── utils.py              # アプリのユーティリティ関数
├── calc_sim_code
│   ├── data_loader.py        # データの読み込みと整形
│   ├── exploratory_analysis.py # 視聴方法別の探索的データ分析
│   ├── recommendation_system.py # レコメンドシステムの構築とユーザー類似度計算
│   ├── utils.py              # 補助的な関数群（ピクルファイルへの保存など）
│   └── main.py               # 実行するとdataframes.pickleを出力
├── dataset
│   ├── anime.csv             # アニメの情報データセット
│   ├── combined_data.json    # 英語タイトルを日本語に変換したデータ
│   ├── rating.csv            # ユーザーのアニメ評価データ
│   └── 日本語訳リスト_個別     # 各アニメの日本語訳を格納したフォルダ
├── .gitignore
├── dataframes.pickle         # データフレームを保存したpickleファイル
├── nohup.out
├── pyproject.toml            # Poetryによる依存関係設定ファイル
├── poetry.lock               # Poetryのロックファイル
├── README.md
└── recommend_anime.zip
```

## アプリケーションの説明

### 目的
ユーザーベースの協調フィルタリングにより、ユーザーに合ったアニメをおすすめするシステムを構築します。

### 使用データ
このプロジェクトでは、myanimelist.netのデータを使用しており、76,000ユーザーのアニメレビューが含まれています。  
使用しているデータセットは以下のKaggleからダウンロードしたオープンデータです。  
[Kaggle: Anime Recommendations Database](https://www.kaggle.com/datasets/CooperUnion/anime-recommendations-database)

- **anime.csv**:
  - アニメの情報を含むデータセット
  - 各カラムの詳細:
    - `anime_id`: アニメのユニークID
    - `name`: アニメのフルネーム
    - `genre`: アニメのジャンル
    - `type`: 視聴タイプ（映画、テレビ、OVAなど）
    - `episodes`: エピソード数
    - `rating`: 平均評価点
    - `members`: アニメの視聴者数

- **rating.csv**:
  - ユーザーの評価情報
  - 各カラムの詳細:
    - `user_id`: ランダムに生成されたユーザーID
    - `anime_id`: 評価対象のアニメID
    - `rating`: ユーザーが割り当てた評価（-1の場合は未評価）

- **combined_data.json**:
  - 英語表記のアニメタイトルを日本語に変換したデータを含むJSONファイル

## 必要なライブラリ

このプロジェクトを実行するためには、[Poetry](https://python-poetry.org/) を使用して依存関係を管理しています。

Poetryをインストールしていない場合は、以下のコマンドでインストールしてください:

```sh
curl -sSL https://install.python-poetry.org | python3 -
```

必要なパッケージをインストールするには、プロジェクトのルートディレクトリで以下のコマンドを実行してください:

```sh
poetry install
```

Poetryシェルに入って実行するか、各コマンドの前に `poetry run` を付けることで、プロジェクトを実行できます。

## 実行方法

このアプリケーションを実行するには、Streamlitを使用します。

### アプリケーションの実行

1. **calc_sim_codeディレクトリ内のモジュールの実行**  
   データを読み込み、探索的分析を行い、レコメンドシステムを構築するために、`calc_sim_code/main.py`を実行します。この処理により`dataframes.pickle`ファイルが生成されます。

   ```sh
   poetry run python calc_sim_code/main.py
   ```

2. **アプリケーションの実行**  
   次に、ターミナルで以下のコマンドを実行し、アニメおすすめアプリを起動します:

   ```sh
   poetry run streamlit run app/anime_app.py
   ```

3. ウェブブラウザが開き、アニメおすすめアプリが表示されます。

## 機能説明

- **アニメ検索条件の設定**:
  - タイトル、ジャンル、評価点、視聴者数などでアニメを絞り込むことができます。
  
- **ユーザー選択**:
  - 対象のユーザーを選択し、そのユーザーがすでに視聴したアニメを表示します。

- **類似ユーザーの抽出**:
  - 対象ユーザーと類似度の高い他のユーザーを基にアニメを推薦します。
  - おすすめ度は各類似ユーザーの評価点と類似度の積を使用して計算されます。

## データフロー

1. **データの読み込み** (`data_loader.py`): 初期化時にデータセットを読み込みます。
2. **探索的分析** (`exploratory_analysis.py`): アニメの視聴方法別に探索的データ分析を行います。
3. **レコメンドシステムの構築** (`recommendation_system.py`): ユーザー間の類似度計算を含むレコメンドシステムを構築します。
4. **データの保存** (`utils.py`): データフレームをピクルファイルに保存し、`dataframes.pickle`として出力します。
5. **アプリケーション実行** (`anime_app.py`): 保存されたデータを用いてStreamlitアプリを動かし、ユーザーにアニメをレコメンドします。

## 今後の課題

- レコメンドの精度向上のため、他の協調フィルタリング手法やコンテンツベースの推薦手法を追加すること。
- アプリケーションのUI/UXを改善し、ユーザーにとって使いやすいインターフェースを提供すること。
- 日本語対応の拡充と、ユーザーインタラクションの向上。

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。